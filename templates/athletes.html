{% extends "base.html" %}

{% block content %}
<section class="athletes-list">
    <h2>Registered Athletes</h2>
    
    <div class="search-filter">
        <form method="GET" action="{{ url_for('athletes') }}">
            <input type="text" id="search" name="search" placeholder="Search by ID or name..." value="{{ search_query }}">
            <button type="submit">Search</button>
        </form>
    </div>
    
    <div class="athletes-grid">
        {% for athlete in athletes %}
        <div class="athlete-card">
            <div class="athlete-header">
                <h3>{{ athlete.full_name }}</h3>
                <span class="id-badge">ID: {{ athlete.id }}</span>
                <span class="days-badge {% if athlete.days_remaining < 7 %}expiring{% endif %}">
                    {{ athlete.days_remaining }} days left
                </span>
            </div>
            <div class="athlete-details">
                <p><strong>ID:</strong> {{ athlete.id }}</p>
                <p><strong>Phone:</strong> {{ athlete.phone }}</p>
                <p><strong>Emergency:</strong> {{ athlete.emergency_phone if athlete.emergency_phone else 'N/A' }}</p>
                <p><strong>Father:</strong> {{ athlete.father_name if athlete.father_name else 'N/A' }}</p>
                <p><strong>Birth Date:</strong> {{ athlete.birth_date if athlete.birth_date else 'N/A' }}</p>
                <p><strong>Registered:</strong> {{ athlete.registration_date }}</p>
                <p><strong>Start Date:</strong> {{ athlete.start_date }}</p>
                <p><strong>Original Period:</strong> {{ athlete.original_days }} days</p>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<script>
    document.getElementById('search').addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const cards = document.querySelectorAll('.athlete-card');
        
        cards.forEach(card => {
            const name = card.querySelector('h3').textContent.toLowerCase();
            if (name.includes(searchTerm)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    });
</script>
{% endblock %}